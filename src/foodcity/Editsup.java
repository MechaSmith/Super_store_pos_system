/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package foodcity;

import java.sql.ResultSet;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Vector;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author Samith
 */
public class Editsup extends javax.swing.JPanel {

    int tb1click;
    int tb2click;

    public Editsup() {
        initComponents();
        tb1click = 0;
        tb2click = 0;
        tb1load();
        gemsupid();
        tblload();

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        esname = new javax.swing.JTextField();
        estp1 = new javax.swing.JTextField();
        estp2 = new javax.swing.JTextField();
        esmail = new javax.swing.JTextField();
        jScrollPane2 = new javax.swing.JScrollPane();
        jList1 = new javax.swing.JList();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        esno = new javax.swing.JTextField();
        esetreet = new javax.swing.JTextField();
        escity = new javax.swing.JTextField();
        st = new javax.swing.JLabel();
        esid = new javax.swing.JTextField();
        esearch = new javax.swing.JButton();
        esupdate = new javax.swing.JButton();
        escansel = new javax.swing.JButton();
        jLabel13 = new javax.swing.JLabel();
        esjdate = new com.toedter.calendar.JDateChooser();
        jLabel14 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        update = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        activate = new javax.swing.JButton();
        deactivate = new javax.swing.JButton();
        jScrollPane3 = new javax.swing.JScrollPane();
        jList2 = new javax.swing.JList<>();
        jLabel16 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        jLabel22 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        jLabel24 = new javax.swing.JLabel();
        jScrollPane4 = new javax.swing.JScrollPane();
        tb1 = new javax.swing.JTable();
        jButton2 = new javax.swing.JButton();
        jButton1 = new javax.swing.JButton();
        jScrollPane5 = new javax.swing.JScrollPane();
        tb2 = new javax.swing.JTable();
        jLabel25 = new javax.swing.JLabel();
        jLabel26 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();

        setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel1.setFont(new java.awt.Font("Prototype", 1, 20)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setText("E D I T   S U P P L I E R");
        add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 10, 270, -1));

        jLabel4.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(255, 255, 255));
        jLabel4.setText("Name   :");
        add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 220, -1, -1));

        jLabel5.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(255, 255, 255));
        jLabel5.setText("Telephone 1  :");
        add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(410, 50, -1, -1));

        jLabel6.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        jLabel6.setForeground(new java.awt.Color(255, 255, 255));
        jLabel6.setText("Telephone 2   :");
        add(jLabel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(410, 90, -1, -1));

        jLabel7.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        jLabel7.setForeground(new java.awt.Color(255, 255, 255));
        jLabel7.setText("E-mail   :");
        add(jLabel7, new org.netbeans.lib.awtextra.AbsoluteConstraints(410, 130, -1, -1));

        jLabel8.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        jLabel8.setForeground(new java.awt.Color(255, 255, 255));
        jLabel8.setText("Joined Date   :");
        add(jLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 250, 110, -1));

        esname.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                esnameActionPerformed(evt);
            }
        });
        add(esname, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 220, 150, -1));

        estp1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                estp1ActionPerformed(evt);
            }
        });
        estp1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                estp1KeyTyped(evt);
            }
        });
        add(estp1, new org.netbeans.lib.awtextra.AbsoluteConstraints(540, 50, 120, 30));

        estp2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                estp2ActionPerformed(evt);
            }
        });
        estp2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                estp2KeyTyped(evt);
            }
        });
        add(estp2, new org.netbeans.lib.awtextra.AbsoluteConstraints(540, 90, 120, 30));
        add(esmail, new org.netbeans.lib.awtextra.AbsoluteConstraints(540, 130, 120, 30));

        jList1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jList1MouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(jList1);

        add(jScrollPane2, new org.netbeans.lib.awtextra.AbsoluteConstraints(130, 120, 100, 60));

        jLabel9.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        jLabel9.setForeground(new java.awt.Color(255, 255, 255));
        jLabel9.setText("No   :");
        add(jLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(410, 180, -1, 50));

        jLabel10.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        jLabel10.setForeground(new java.awt.Color(255, 255, 255));
        jLabel10.setText("Street  :");
        add(jLabel10, new org.netbeans.lib.awtextra.AbsoluteConstraints(410, 220, -1, 50));

        jLabel11.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        jLabel11.setForeground(new java.awt.Color(255, 255, 255));
        jLabel11.setText("City   :");
        add(jLabel11, new org.netbeans.lib.awtextra.AbsoluteConstraints(410, 260, -1, 50));

        esno.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                esnoActionPerformed(evt);
            }
        });
        add(esno, new org.netbeans.lib.awtextra.AbsoluteConstraints(490, 190, 150, 30));

        esetreet.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                esetreetActionPerformed(evt);
            }
        });
        add(esetreet, new org.netbeans.lib.awtextra.AbsoluteConstraints(490, 230, 150, 30));

        escity.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                escityActionPerformed(evt);
            }
        });
        add(escity, new org.netbeans.lib.awtextra.AbsoluteConstraints(490, 270, 150, 30));

        st.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        st.setForeground(new java.awt.Color(255, 255, 255));
        add(st, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 300, 70, 30));

        esid.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                esidActionPerformed(evt);
            }
        });
        esid.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                esidKeyReleased(evt);
            }
        });
        add(esid, new org.netbeans.lib.awtextra.AbsoluteConstraints(130, 90, 100, 30));

        esearch.setBackground(new java.awt.Color(255, 0, 255));
        esearch.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        esearch.setIcon(new javax.swing.ImageIcon(getClass().getResource("/pic/srch.png"))); // NOI18N
        esearch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                esearchActionPerformed(evt);
            }
        });
        add(esearch, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 90, 60, 30));

        esupdate.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        esupdate.setText("UPDATE");
        esupdate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                esupdateActionPerformed(evt);
            }
        });
        add(esupdate, new org.netbeans.lib.awtextra.AbsoluteConstraints(1420, 180, -1, -1));

        escansel.setBackground(new java.awt.Color(255, 51, 0));
        escansel.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        escansel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/pic/ecan.png"))); // NOI18N
        escansel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                escanselActionPerformed(evt);
            }
        });
        add(escansel, new org.netbeans.lib.awtextra.AbsoluteConstraints(890, 320, 140, -1));

        jLabel13.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Info", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 14), new java.awt.Color(255, 255, 255))); // NOI18N
        add(jLabel13, new org.netbeans.lib.awtextra.AbsoluteConstraints(380, 170, 320, 140));
        add(esjdate, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 250, 150, -1));

        jLabel14.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Info", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 14), new java.awt.Color(255, 255, 255))); // NOI18N
        add(jLabel14, new org.netbeans.lib.awtextra.AbsoluteConstraints(380, 30, 320, 140));

        jLabel15.setText(" ");
        jLabel15.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Info", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 14), new java.awt.Color(255, 255, 255))); // NOI18N
        add(jLabel15, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 200, 330, 90));

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "supplier id", "name", "joined date", "telephone ", "E mail", "status"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jTable1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable1MouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(jTable1);

        add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 360, 1010, 160));

        update.setBackground(new java.awt.Color(255, 0, 255));
        update.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        update.setIcon(new javax.swing.ImageIcon(getClass().getResource("/pic/eup.png"))); // NOI18N
        update.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                updateActionPerformed(evt);
            }
        });
        add(update, new org.netbeans.lib.awtextra.AbsoluteConstraints(730, 320, 140, -1));

        jLabel2.setForeground(new java.awt.Color(255, 255, 255));
        jLabel2.setText("Status 0 = Not Available");
        add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(800, 30, 220, 20));

        jLabel3.setForeground(new java.awt.Color(255, 255, 255));
        jLabel3.setText("Status 1 = Available");
        add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(800, 10, 220, 20));

        activate.setBackground(new java.awt.Color(255, 0, 255));
        activate.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        activate.setIcon(new javax.swing.ImageIcon(getClass().getResource("/pic/eact.png"))); // NOI18N
        activate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                activateActionPerformed(evt);
            }
        });
        add(activate, new org.netbeans.lib.awtextra.AbsoluteConstraints(410, 320, 140, -1));

        deactivate.setBackground(new java.awt.Color(255, 0, 255));
        deactivate.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        deactivate.setIcon(new javax.swing.ImageIcon(getClass().getResource("/pic/edac.png"))); // NOI18N
        deactivate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                deactivateActionPerformed(evt);
            }
        });
        add(deactivate, new org.netbeans.lib.awtextra.AbsoluteConstraints(570, 320, 140, -1));

        jScrollPane3.setViewportView(jList2);

        add(jScrollPane3, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 120, 110, 60));

        jLabel16.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        jLabel16.setForeground(new java.awt.Color(255, 255, 255));
        jLabel16.setText("Supplier ID  :");
        add(jLabel16, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 90, -1, 30));

        jLabel17.setFont(new java.awt.Font("Calibri Light", 0, 18)); // NOI18N
        jLabel17.setForeground(new java.awt.Color(255, 255, 255));
        jLabel17.setText("Status :");
        add(jLabel17, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 300, -1, 30));

        jLabel18.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel18.setForeground(new java.awt.Color(255, 0, 0));
        jLabel18.setText("*");
        add(jLabel18, new org.netbeans.lib.awtextra.AbsoluteConstraints(290, 220, 20, 20));

        jLabel19.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel19.setForeground(new java.awt.Color(255, 0, 0));
        jLabel19.setText("*");
        add(jLabel19, new org.netbeans.lib.awtextra.AbsoluteConstraints(290, 250, 20, 20));

        jLabel20.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel20.setForeground(new java.awt.Color(255, 0, 0));
        jLabel20.setText("*");
        add(jLabel20, new org.netbeans.lib.awtextra.AbsoluteConstraints(640, 190, 20, 20));

        jLabel21.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel21.setForeground(new java.awt.Color(255, 0, 0));
        jLabel21.setText("*");
        add(jLabel21, new org.netbeans.lib.awtextra.AbsoluteConstraints(640, 230, 20, 20));

        jLabel22.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel22.setForeground(new java.awt.Color(255, 0, 0));
        jLabel22.setText("*");
        add(jLabel22, new org.netbeans.lib.awtextra.AbsoluteConstraints(640, 280, 20, 20));

        jLabel23.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel23.setForeground(new java.awt.Color(255, 0, 0));
        jLabel23.setText("*");
        add(jLabel23, new org.netbeans.lib.awtextra.AbsoluteConstraints(660, 50, 20, 20));

        jLabel24.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel24.setForeground(new java.awt.Color(255, 0, 0));
        jLabel24.setText("*");
        add(jLabel24, new org.netbeans.lib.awtextra.AbsoluteConstraints(660, 140, 20, 20));

        tb1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Item Id", "Name"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tb1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tb1MouseClicked(evt);
            }
        });
        jScrollPane4.setViewportView(tb1);

        add(jScrollPane4, new org.netbeans.lib.awtextra.AbsoluteConstraints(710, 90, 130, 220));

        jButton2.setBackground(new java.awt.Color(0, 102, 102));
        jButton2.setForeground(new java.awt.Color(255, 255, 255));
        jButton2.setText(">");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        add(jButton2, new org.netbeans.lib.awtextra.AbsoluteConstraints(850, 180, 40, 30));

        jButton1.setBackground(new java.awt.Color(0, 102, 102));
        jButton1.setForeground(new java.awt.Color(255, 255, 255));
        jButton1.setText("<");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        add(jButton1, new org.netbeans.lib.awtextra.AbsoluteConstraints(850, 220, 40, 30));

        tb2.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Item Id", "Name"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tb2.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tb2MouseClicked(evt);
            }
        });
        jScrollPane5.setViewportView(tb2);

        add(jScrollPane5, new org.netbeans.lib.awtextra.AbsoluteConstraints(900, 90, 130, 220));

        jLabel25.setForeground(new java.awt.Color(255, 255, 255));
        jLabel25.setText("Available Item");
        add(jLabel25, new org.netbeans.lib.awtextra.AbsoluteConstraints(710, 60, 130, 20));

        jLabel26.setForeground(new java.awt.Color(255, 255, 255));
        jLabel26.setText("To Supplier");
        add(jLabel26, new org.netbeans.lib.awtextra.AbsoluteConstraints(900, 60, 130, 20));

        jLabel12.setIcon(new javax.swing.ImageIcon(getClass().getResource("/pic/ll.png"))); // NOI18N
        add(jLabel12, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 1050, 540));
    }// </editor-fold>//GEN-END:initComponents

    private void esupdateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_esupdateActionPerformed
        try {
            db.iud("Update supplier set sup_id='" + esid.getText() + "',name='" + esname.getText() + "',joined_date='" + esjdate.getDate() + "',tp1='" + estp1.getText() + "',tp2='" + estp2.getText() + "',mail='" + esmail.getText() + "',no='" + esno.getText() + "',street='" + esetreet.getText() + "',city='" + escity.getText() + "' where sup_id='" + esid.getText() + "' ");

            esno.setText(null);
            esname.setText(null);
            esjdate.setDate(null);
            estp1.setText(null);
            estp2.setText(null);
            esmail.setText(null);
            esno.setText(null);
            esetreet.setText(null);
            escity.setText(null);
            gemsupid();

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }//GEN-LAST:event_esupdateActionPerformed

    private void escanselActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_escanselActionPerformed
        esid.setEditable(true);
        clr();
        tblload();
        DefaultTableModel dtm=(DefaultTableModel)tb2.getModel();
        dtm.setRowCount(0);
          tb1load();
       
    }//GEN-LAST:event_escanselActionPerformed

    private void esearchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_esearchActionPerformed

        try {
            ResultSet rs = (ResultSet) db.search("Select a.*,b.*,c.* from((supplier a inner join sup_address b on a.sup_id=b.supplier_sup_id)"
                    + "inner join sup_contact c on a.sup_id=c.supplier_sup_id)where a.sup_id ='" + esid.getText() + "' or a.name='" + esid.getText() + "' ");
            if (rs.next()) {
                System.out.println("elaaa");
                esname.setText(rs.getString("name"));
                esjdate.setDate(rs.getDate("joined_date"));
                esno.setText(rs.getString("no"));
                esetreet.setText(rs.getString("street"));
                escity.setText(rs.getString("city"));
                estp1.setText(rs.getString("tp1"));
                estp2.setText(rs.getString("tp2"));
                esmail.setText(rs.getString("mail"));
                st.setText(rs.getString("status"));
                esid.setEditable(false);

            } else {
                JOptionPane.showMessageDialog(this, "Wrong supplier details ", "Error", JOptionPane.ERROR_MESSAGE);
                esid.setText(null);
                esid.grabFocus();
            }

        } catch (Exception ex) {
            ex.printStackTrace();
        }


    }//GEN-LAST:event_esearchActionPerformed

    private void esidActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_esidActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_esidActionPerformed

    private void jList1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jList1MouseClicked
        esid.setText((String) jList1.getSelectedValue());
        jList1.setVisible(false);
        jList2.setVisible(false);
    }//GEN-LAST:event_jList1MouseClicked

    private void esidKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_esidKeyReleased
        try {
            ResultSet rs = (ResultSet) db.search("select * from supplier where sup_id like '%" + esid.getText() + "%' or name like '%" + esid.getText() + "%'");
            Vector v = new Vector();
            Vector v1 = new Vector();
            while (rs.next()) {
                v.add(rs.getString("sup_id"));
                v1.add(rs.getString("name"));
            }
            jList1.setListData(v);
            jList2.setListData(v1);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_esidKeyReleased

    private void updateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_updateActionPerformed
        String s = st.getText();
        int l=tb2.getRowCount();
        if (s.length() == 0) {
            JOptionPane.showMessageDialog(this, "Please select supplier fro edit", "Error", JOptionPane.ERROR_MESSAGE);
        } else if (esname.getText().length() == 0 || esjdate.getDate() == null || esno.getText().length() == 0 || esetreet.getText().length() == 0
                || escity.getText().length() == 0 || estp1.getText().length() == 0) {
            JOptionPane.showMessageDialog(this, "Must fill  all highlight point", "Error", JOptionPane.ERROR_MESSAGE);
        }else if (l==0){
         JOptionPane.showMessageDialog(this, "Must add item", "Error", JOptionPane.ERROR_MESSAGE);
       
        }
        else{
        
        try {
            Date d = esjdate.getDate();
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
            String dt = sdf.format(d);
            db.iud("update supplier set name='" + esname.getText() + "',status='1',joined_date='" + dt + "' where sup_id='" + esid.getText() + "'");
            db.iud("update sup_contact set tp1='" + estp1.getText() + "', tp2='" + estp2.getText() + "',mail='" + esmail.getText() + "' where supplier_sup_id='" + esid.getText() + "'");
            db.iud("update sup_address set no='" + esno.getText() + "',street='" + esetreet.getText() + "',city='" + escity.getText() + "' where supplier_sup_id='" + esid.getText() + "'");
            db.iud("delete from item_has_supplier where supplier_sup_id='"+esid.getText()+"'");
             for (int i = 0; i < tb2.getRowCount(); i++) {
                    db.iud("insert into item_has_supplier values('" + tb2.getValueAt(i, 0) + "','" + esid.getText() + "')");

                }
            DefaultTableModel dtm=(DefaultTableModel)tb2.getModel();
            dtm.setRowCount(0);
              tblload();
            JOptionPane.showMessageDialog(this, "Success");
        } catch (Exception e) {
            e.printStackTrace();
        }
       
        tb1load();
        clr();
        }
        
    }//GEN-LAST:event_updateActionPerformed

    private void jTable1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable1MouseClicked
        int x = jTable1.getSelectedRow();
        esid.setText(jTable1.getValueAt(x, 0).toString());
        try {
            ResultSet rs = (ResultSet) db.search("select a.*,b.*,c.* from((supplier a inner join sup_address b on a.sup_id=b.supplier_sup_id)"
                    + "inner join sup_contact c on a.sup_id=c.supplier_sup_id) where sup_id='" + esid.getText() + "'");
            if (rs.next()) {
                esname.setText(rs.getString("name"));
                Date date;
                try {
                    date = new SimpleDateFormat("yyyy-MM-dd").parse((String) jTable1.getValueAt(x, 2));
                    esjdate.setDate(date);
                } catch (Exception ex) {
                    ex.printStackTrace();
                }
                esno.setText(rs.getString("no"));
                esetreet.setText(rs.getString("street"));
                escity.setText(rs.getString("city"));
                estp1.setText(rs.getString("tp1"));
                estp2.setText(rs.getString("tp2"));
                esmail.setText(rs.getString("mail"));
                st.setText(rs.getString("status"));
                ResultSet rs1 = db.search("select a.*,b.* from(item_has_supplier a  inner  join item b on a.item_item_id=b.item_id) where supplier_sup_id='" + jTable1.getValueAt(x, 0).toString() + "'");

                DefaultTableModel dtm = (DefaultTableModel) tb2.getModel();
                dtm.setRowCount(0);
                while (rs1.next()) {
                    Vector v = new Vector();
                    v.add(rs1.getString("item_id"));
                    v.add(rs1.getString("name"));
                    dtm.addRow(v);
                    tb1load();

                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        DefaultTableModel dtm = (DefaultTableModel) jTable1.getModel();
        dtm.setRowCount(0);
        tblload();

    }//GEN-LAST:event_jTable1MouseClicked

    private void deactivateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_deactivateActionPerformed

        try {
            ResultSet rs = (ResultSet) db.search("select status from supplier where sup_id='" + esid.getText() + "'");
            {
                if (rs.next()) {
                    String st = rs.getString("status");
                    if (st.equalsIgnoreCase("0")) {

                        JOptionPane.showMessageDialog(this, "This supplier already deactiveted", "Warning", JOptionPane.WARNING_MESSAGE);
                    } else {

                        db.iud("update supplier set status='0' where sup_id='" + esid.getText() + "'");
                        JOptionPane.showMessageDialog(this, "Success");
                    }
                }
            }
            clr();
  
            tblload();
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }//GEN-LAST:event_deactivateActionPerformed

    private void activateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_activateActionPerformed
        try {
            ResultSet rs = (ResultSet) db.search("select status from supplier where sup_id='" + esid.getText() + "'");
            {
                if (rs.next()) {
                    String st = rs.getString("status");
                    if (st.equalsIgnoreCase("1")) {

                        JOptionPane.showMessageDialog(this, "This supplier already activeted", "Warning", JOptionPane.WARNING_MESSAGE);
                    } else {

                        db.iud("update supplier set status='1' where sup_id='" + esid.getText() + "'");
                        JOptionPane.showMessageDialog(this, "Success");

                    }
                }
            }
            clr();

            tblload();
        } catch (Exception ex) {
            ex.printStackTrace();
        }

    }//GEN-LAST:event_activateActionPerformed

    private void esnameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_esnameActionPerformed
        esno.grabFocus();
    }//GEN-LAST:event_esnameActionPerformed

    private void esnoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_esnoActionPerformed
        esetreet.grabFocus();
    }//GEN-LAST:event_esnoActionPerformed

    private void esetreetActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_esetreetActionPerformed
        escity.grabFocus();
    }//GEN-LAST:event_esetreetActionPerformed

    private void escityActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_escityActionPerformed
        estp1.grabFocus();
    }//GEN-LAST:event_escityActionPerformed

    private void estp1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_estp1ActionPerformed
        estp2.grabFocus();

    }//GEN-LAST:event_estp1ActionPerformed

    private void estp2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_estp2ActionPerformed
        esmail.grabFocus();
    }//GEN-LAST:event_estp2ActionPerformed

    private void estp1KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_estp1KeyTyped
        char c = evt.getKeyChar();
        if (c >= '0' && c <= '9') {
            if (estp1.getText().length() == 10) {
                evt.consume();
            }
        } else {
            evt.consume();

        }
    }//GEN-LAST:event_estp1KeyTyped

    private void estp2KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_estp2KeyTyped
        char c = evt.getKeyChar();
        if (c >= '0' && c <= '9') {
            if (estp2.getText().length() == 10) {
                evt.consume();
            }
        } else {
            evt.consume();

        }
    }//GEN-LAST:event_estp2KeyTyped

    private void tb1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tb1MouseClicked
        tb1click = 1;
    }//GEN-LAST:event_tb1MouseClicked

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        if (tb1click == 0) {
            JOptionPane.showMessageDialog(this, "Not selet item", "Error", JOptionPane.ERROR_MESSAGE);
        } else {
            int y = 0;
            int x = tb1.getSelectedRow();
            DefaultTableModel dtm = (DefaultTableModel) tb1.getModel();
            String id = tb1.getValueAt(x, 0).toString();
            String name = tb1.getValueAt(x, 1).toString();
            for (int i = 0; i < tb2.getRowCount(); i++) {
                if (tb1.getValueAt(x, 0).toString().equals(tb2.getValueAt(i, 0))) {
                    dtm.removeRow(x);
                   y=1;
                }
            }
            if (y==0) {
                System.out.println(y);
                DefaultTableModel dtm1 = (DefaultTableModel) tb2.getModel();
                Vector v = new Vector();
                v.add(id);
                v.add(name);
                dtm1.addRow(v);
                dtm.removeRow(x);
            }

        }
        tb1click = 0;
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        
         if (tb2click == 0) {
            JOptionPane.showMessageDialog(this, "Not selet item", "Error", JOptionPane.ERROR_MESSAGE);
        } else {
            int y = 0;
            int x = tb2.getSelectedRow();
            DefaultTableModel dtm = (DefaultTableModel) tb2.getModel();
            String id = tb2.getValueAt(x, 0).toString();
            String name = tb2.getValueAt(x, 1).toString();
            for (int i = 0; i < tb2.getRowCount(); i++) {
                if (tb2.getValueAt(x, 0).toString().equals(tb1.getValueAt(i, 0))) {
                    dtm.removeRow(x);
                   y=1;
                }
            }
            if (y==0) {
                System.out.println(y);
                DefaultTableModel dtm1 = (DefaultTableModel) tb1.getModel();
                Vector v = new Vector();
                v.add(id);
                v.add(name);
                dtm1.addRow(v);
                dtm.removeRow(x);
            }

        }
        
        
        
        
      
    }//GEN-LAST:event_jButton1ActionPerformed

    private void tb2MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tb2MouseClicked
        tb2click = 1;
    }//GEN-LAST:event_tb2MouseClicked


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton activate;
    private javax.swing.JButton deactivate;
    private javax.swing.JButton escansel;
    private javax.swing.JTextField escity;
    private javax.swing.JButton esearch;
    private javax.swing.JTextField esetreet;
    private javax.swing.JTextField esid;
    private com.toedter.calendar.JDateChooser esjdate;
    private javax.swing.JTextField esmail;
    private javax.swing.JTextField esname;
    private javax.swing.JTextField esno;
    private javax.swing.JTextField estp1;
    private javax.swing.JTextField estp2;
    private javax.swing.JButton esupdate;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JList jList1;
    private javax.swing.JList<String> jList2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JTable jTable1;
    private javax.swing.JLabel st;
    private javax.swing.JTable tb1;
    private javax.swing.JTable tb2;
    private javax.swing.JButton update;
    // End of variables declaration//GEN-END:variables

    private void gemsupid() {

    }

    private void tblload() {
        try {
            ResultSet rs = (ResultSet) db.search("select a.*,b.* from(supplier a inner join sup_contact b on a.sup_id=supplier_sup_id)");
            DefaultTableModel dtm = (DefaultTableModel) jTable1.getModel();
            dtm.setRowCount(0);
            while (rs.next()) {
                Vector v = new Vector();
                v.add(rs.getString("sup_id"));
                v.add(rs.getString("name"));
                v.add(rs.getString("joined_date"));
                v.add(rs.getString("tp1"));
                v.add(rs.getString("mail"));
                v.add(rs.getString("status"));
                dtm.addRow(v);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    private void clr() {
        esid.setText(null);
        esname.setText(null);
        esjdate.setDate(null);
        esno.setText(null);
        esetreet.setText(null);
        escity.setText(null);
        estp1.setText(null);
        estp2.setText(null);
        esmail.setText(null);
        st.setText(null);
    }

    private void tb1load() {
        try {
            int x = 0;
            java.sql.ResultSet rs1 = db.search("select * from item");
            DefaultTableModel dtm = (DefaultTableModel) tb1.getModel();
            dtm.setRowCount(0);
            while (rs1.next()) {

                Vector v = new Vector();
                v.add(rs1.getString("item_id"));
                v.add(rs1.getString("name"));
                dtm.addRow(v);

            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
